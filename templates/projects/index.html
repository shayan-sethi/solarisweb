{% extends "base.html" %}

{% block content %}
<section class="max-w-6xl mx-auto px-6 py-12">
    <div class="mb-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
            <h1 class="text-3xl font-bold text-slate-800">Solar projects</h1>
            <p class="text-slate-500 mt-2">Track rooftop sites, EPC partners and site photos just like the Expo project log.</p>
        </div>
        <a href="{{ url_for('projects.add_project') }}" class="inline-flex items-center gap-2 bg-cyan-500 hover:bg-cyan-600 text-white font-semibold px-4 py-3 rounded-lg shadow transition">
            Add new project
        </a>
    </div>

    {% if simulated_data %}
        <div class="bg-sky-50 border border-sky-200 text-sky-700 px-6 py-4 rounded-2xl shadow-inner mb-6">
            Showing automated sample projects so you can explore the project tracking features before adding your own installations.
        </div>
    {% endif %}

    {% if projects %}
        <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
            {% for project in projects %}
                <article class="glass rounded-2xl shadow overflow-hidden flex flex-col">
                    {% if project.image_filename %}
                        <img src="{{ url_for('static', filename='uploads/' ~ project.image_filename) }}" alt="{{ project.name }}" class="h-40 w-full object-cover">
                    {% else %}
                        <div class="h-40 w-full bg-slate-200 flex items-center justify-center text-slate-500 text-sm">
                            Site photo pending
                        </div>
                    {% endif %}
                    <div class="p-5 flex-1 flex flex-col gap-3">
                        <div class="flex items-center justify-between">
                            <h2 class="text-xl font-semibold text-slate-800">{{ project.name }}</h2>
                            <span class="text-xs font-semibold px-3 py-1 rounded-full bg-emerald-100 text-emerald-700">{{ project.system_type|replace('-', ' ')|title }}</span>
                        </div>
                        {% if project.detail %}
                            <p class="text-sm text-slate-500 overflow-hidden text-ellipsis whitespace-nowrap">{{ project.detail }}</p>
                        {% endif %}
                        <div class="mt-auto flex items-center justify-between text-xs text-slate-400">
                            <span>{{ project.installation_date.strftime('%d %b %Y') if project.installation_date else 'Install date TBD' }}</span>
                            {% if not simulated_data %}
                                <a class="text-cyan-600 hover:text-cyan-700 font-semibold" href="{{ url_for('projects.project_detail', project_id=project.id) }}">View</a>
                            {% else %}
                                <span class="text-slate-400 text-xs">Demo project</span>
                            {% endif %}
                        </div>
                    </div>
                </article>
            {% endfor %}
        </div>
    {% else %}
        <div class="glass rounded-2xl p-8 text-center text-slate-500">
            No projects recorded yet. Add your first rooftop installation to keep EPC contacts, site photos and subsidy status organised.
        </div>
    {% endif %}
</section>
{% endblock %}

